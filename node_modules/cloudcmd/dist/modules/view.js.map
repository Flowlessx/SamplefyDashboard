{"version":3,"sources":["file://cloudcmd/webpack/bootstrap","file://cloudcmd/client/modules/view.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","17","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","require","itype","rendy","exec","currify","promisify","modal","createElement","time","FS","Files","Events","load","Images","encode","testRegExp","reg","test","addEvent","fn","el","cb","lifo","add","getRegExp","ext","RegExp","concat","loadCSS","css","show","options","prefixURL","CloudCmd","Loading","bindKeys","addKey","listener","El","className","notAppend","tabIndex","append","open","Config","config","_objectSpread","keys","forEach","isConfig","item","func","series","initConfig","path","Info","isImage","isAudio","isVideo","isMedia","getType","getData","error","hide","element","document","createTextNode","title","names","files","map","DOM","getCurrentPath","filter","titles","href","basename","index","indexOf","autoSize","arrows","helpers","viewImage","src","callback","allConfig","afterShow","querySelector","focus","Error","check","template","alert","TemplateAudio","is","type","innerHTML","viewMedia","Name","CurrentInfo","Key","a","split","pop","beforeShow","unsetBind","beforeClose","rmKey","setBind","onOverlayClick","afterClose","close","some","prefix","event","position","getCurrentByPosition","filesPassive","isFiles","isFilesPassive","isCurrentFile","setCurrentFile","setCurrentByPosition","x","clientX","y","clientY","_ref2","keyCode","ESC","init","_asyncToGenerator","loadAll","Overlay"],"mappings":"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","file":"./modules/view.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t17: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([89,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","'use strict';\n\n/* global CloudCmd, DOM */\n\nrequire('../../css/view.css');\n\nconst itype = require('itype/legacy');\nconst rendy = require('rendy/legacy');\nconst exec = require('execon');\nconst currify = require('currify/legacy');\nconst {promisify} = require('es6-promisify');\n\nconst modal = require('@cloudcmd/modal');\nconst createElement = require('@cloudcmd/create-element');\n\nconst {time} = require('../../common/util');\nconst {FS} = require('../../common/cloudfunc');\n\nconst Files = require('../dom/files');\nconst Events = require('../dom/events');\nconst load = require('load.js');\nconst Images = require('../dom/images');\n\nconst {encode} = require('../../common/entity');\n\nconst testRegExp = currify((name, reg) => reg.test(name));\nconst lifo = currify((fn, el, cb, name) => fn(name, el, cb));\n\nconst addEvent = lifo(Events.add);\nconst getRegExp = (ext) => RegExp(`\\\\.${ext}$`, 'i');\n\nconst loadCSS = promisify(load.css);\n\nmodule.exports.show = show;\nmodule.exports.hide = hide;\n\nlet Loading = false;\n\nconst Name = 'View';\nCloudCmd[Name] = module.exports;\n\nconst Info = DOM.CurrentInfo;\nconst {Key} = CloudCmd;\nconst basename = (a) => a.split('/').pop();\n\nlet El;\nlet TemplateAudio;\nlet Overlay;\n\nconst Config = {\n    beforeShow: (callback) => {\n        Images.hide();\n        Key.unsetBind();\n        exec(callback);\n    },\n    beforeClose: (callback) => {\n        Events.rmKey(listener);\n        Key.setBind();\n        exec(callback);\n    },\n    afterShow: (callback) => {\n        El.focus();\n        exec(callback);\n    },\n    onOverlayClick,\n    afterClose      : exec,\n    autoSize        : false,\n    helpers: {\n        title: {},\n    },\n};\n\nmodule.exports.init = async () => {\n    await loadAll();\n    \n    const events = [\n        'click',\n        'contextmenu',\n    ];\n    \n    events.forEach(addEvent(Overlay, onOverlayClick));\n};\n\nfunction show(data, options) {\n    const prefixURL = CloudCmd.prefixURL + FS;\n    \n    if (Loading)\n        return;\n    \n    if (!options || options.bindKeys !== false)\n        Events.addKey(listener);\n    \n    El = createElement('div', {\n        className: 'view',\n        notAppend: true,\n    });\n    \n    El.tabIndex = 0;\n    \n    if (data) {\n        El.append(data);\n        modal.open(El, initConfig(Config, options));\n        return;\n    }\n    \n    Images.show.load();\n    \n    const path = prefixURL + Info.path;\n    const type = getType(path);\n    \n    switch(type) {\n    default:\n        return viewFile();\n    \n    case 'image':\n        return viewImage(prefixURL);\n    \n    case 'media':\n        return viewMedia(path);\n    }\n}\n\nfunction viewMedia(path) {\n    getMediaElement(path, (element) => {\n        const allConfig = {\n            ...Config,\n            ...{\n                autoSize: true,\n                afterShow: () => {\n                    element\n                        .querySelector('audio, video')\n                        .focus();\n                },\n            },\n        };\n        \n        modal.open(element, allConfig);\n    });\n}\n\nfunction viewFile() {\n    Info.getData((error, data) => {\n        if (error)\n            return Images.hide();\n        \n        const element = document.createTextNode(data);\n        const options = {\n            ...Config,\n        };\n        \n        if (CloudCmd.config('showFileName'))\n            options.title = Info.name;\n        \n        El.append(element);\n        modal.open(El, options);\n    });\n}\n\nfunction initConfig(Config, options) {\n    const config = {\n        ...Config,\n    };\n    \n    if (!options)\n        return config;\n    \n    Object.keys(options).forEach((name) => {\n        const isConfig = !!config[name];\n        const item = options[name];\n        const isFunc = itype.function(item);\n        \n        if (!isFunc || !isConfig) {\n            config[name] = options[name];\n            return;\n        }\n        \n        const func = config[name];\n        config[name] = () => {\n            exec.series([func, item]);\n        };\n    });\n    \n    return config;\n}\n\nfunction hide() {\n    modal.close();\n}\n\nfunction viewImage(prefixURL) {\n    const makeTitle = (path) => {\n        return {\n            href: prefixURL + path,\n            title: encode(basename(path)),\n        };\n    };\n    \n    const names = Info.files\n        .map(DOM.getCurrentPath)\n        .filter(isImage);\n    \n    const titles = names\n        .map(makeTitle);\n    \n    const index = names.indexOf(Info.path);\n    const imageConfig = {\n        index,\n        autoSize    : true,\n        arrows      : true,\n        keys        : true,\n        helpers     : {\n            title   : {},\n        },\n    };\n    \n    const config = {\n        ...Config,\n        ...imageConfig,\n    };\n    \n    modal.open(titles, config);\n}\n\nfunction isImage(name) {\n    const images = [\n        'jp(e|g|eg)',\n        'gif',\n        'png',\n        'bmp',\n        'webp',\n        'svg',\n        'ico',\n    ];\n    \n    return images\n        .map(getRegExp)\n        .some(testRegExp(name));\n}\n\nfunction isMedia(name) {\n    return isAudio(name) || isVideo(name);\n}\n\nfunction isAudio(name) {\n    return /\\.(mp3|ogg|m4a)$/i.test(name);\n}\n\nfunction isVideo(name) {\n    return /\\.(mp4|avi)$/i.test(name);\n}\n\nfunction getType(name) {\n    if (isImage(name))\n        return 'image';\n    \n    if (isMedia(name))\n        return 'media';\n}\n\nfunction getMediaElement(src, callback) {\n    check(src, callback);\n    \n    Files.get('view/media-tmpl', (error, template) => {\n        const {name} = Info;\n        \n        if (error)\n            return alert(error);\n        \n        if (!TemplateAudio)\n            TemplateAudio = template;\n        \n        const is = isAudio(name);\n        const type = is ? 'audio' : 'video';\n        \n        const innerHTML = rendy(TemplateAudio, {\n            src,\n            type,\n            name,\n        });\n        \n        const element = createElement('div', {\n            innerHTML,\n        });\n        \n        callback(element);\n    });\n}\n\nfunction check(src, callback) {\n    if (typeof src !== 'string')\n        throw Error('src should be a string!');\n    \n    if (typeof callback !== 'function')\n        throw Error('callback should be a function');\n}\n\n/**\n * function loads css and js of FancyBox\n * @callback   -  executes, when everything loaded\n */\nasync function loadAll() {\n    const {prefix} = CloudCmd;\n    \n    time(Name + ' load');\n    \n    Loading = true;\n    await loadCSS(`${prefix}/dist/view.css`);\n    Loading = false;\n}\n\nfunction onOverlayClick(event) {\n    const position = {\n        x: event.clientX,\n        y: event.clientY,\n    };\n    \n    setCurrentByPosition(position);\n}\n\nfunction setCurrentByPosition(position) {\n    const element = DOM.getCurrentByPosition(position);\n    \n    if (!element)\n        return;\n    \n    const {\n        files,\n        filesPassive,\n    } = Info;\n    \n    const isFiles = ~files.indexOf(element);\n    const isFilesPassive = ~filesPassive.indexOf(element);\n    \n    if (!isFiles && !isFilesPassive)\n        return;\n    \n    const isCurrent = DOM.isCurrentFile(element);\n    \n    if (isCurrent)\n        return;\n    \n    DOM.setCurrentFile(element);\n}\n\nfunction listener({keyCode}) {\n    if (keyCode === Key.ESC)\n        hide();\n}\n\n"],"sourceRoot":""}