{"version":3,"sources":["file://cloudcmd/webpack/bootstrap","file://cloudcmd/client/modules/operation/index.js","file://cloudcmd/client/modules/operation/remove-extension.js","file://cloudcmd/client/modules/operation/set-listeners.js","file://cloudcmd/client/modules/operation/format.js","file://cloudcmd/client/modules/operation/get-next-current-name.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","13","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","currify","require","wraptile","promisify","exec","loadJS","js","encode","RESTful","removeExtension","setListeners","getNextCurrentName","removeQuery","a","replace","Name","CloudCmd","Loaded","TITLE","config","DOM","Dialog","Images","initOperations","prefix","socketPrefix","fn","concat","fileop","e","operator","on","authCheck","onConnect","onDisconnect","spawn","ok","accept","alertDialog","alert","emit","Operation","copyFn","cp","moveFn","mv","deleteFn","extractFn","extract","packZipFn","pack","packTarFn","Info","CurrentInfo","showLoad","show","load","processFiles","options","selFiles","panel","shouldAsk","from","to","names","dirPath","getNotCurrentDirPath","getSelectedFiles","getFilenames","panelPassive","getCurrentName","_slicedToArray","sameName","getCurrentByName","noFilesCheck","isCopy","type","option","title","operation","msg","prompt","cancel","message","map","then","ask","go","str","Storage","remove","isOnePanel","refresh","noCurrent","currentName","setCurrentByName","confirm","getActiveFiles","is","Boolean","noFiles","_ref","callback","listen","noContinue","tar","_ref2","zip","files","_ref3","copy","_ref4","move","_ref5","deleteSilent","arguments","undefined","path","removedNames","nextCurrentName","includes","twopack","op","fileFrom","activeFiles","Error","checkEmpty","getPacker","dir","getPackerExt","error","init","series","loadSocket","_CloudCmd2","prefixSocket","file","Util","timeEnd","time","hide","View","msgAsk","current","getCurrentFile","isDir","isCurrentIsDir","getType","promptDelete","getExt","ext","test","getExtension","smalltalk","forEachKey","format","emitter","done","lastError","onAbort","abort","noCancel","removeListener","progress","listeners","setProgress","end","not","array","indexOf","notOneOf","b","filter","nextNames"],"mappings":"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","file":"./modules/operation.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t13: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([100,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","/* global CloudCmd */\n/* global Util */\n/* global DOM */\n/* global fileop */\n\n'use strict';\n\nconst currify = require('currify/legacy');\nconst wraptile = require('wraptile/legacy');\nconst {promisify} = require('es6-promisify');\nconst exec = require('execon');\nconst loadJS = require('load.js').js;\n\nconst {encode} = require('../../../common/entity');\n\nconst RESTful = require('../../dom/rest');\nconst removeExtension = require('./remove-extension');\nconst setListeners = require('./set-listeners');\nconst getNextCurrentName = require('./get-next-current-name');\n\nconst removeQuery = (a) => a.replace(/\\?.*/, '');\n\nconst Name = 'Operation';\nCloudCmd[Name] = exports;\n\nconst {\n    TITLE,\n    config,\n} = CloudCmd;\nconst {Dialog, Images} = DOM;\nconst initOperations = wraptile(_initOperations);\nconst authCheck = wraptile(_authCheck);\n\nconst Operation = {};\n\nlet Loaded;\n\nlet {\n    cp: copyFn,\n    mv: moveFn,\n    delete: deleteFn,\n    extract: extractFn,\n} = RESTful;\n\nlet packZipFn = RESTful.pack;\nlet packTarFn = RESTful.pack;\n\nconst Info = DOM.CurrentInfo;\nconst showLoad = Images.show.load.bind(null, 'top');\n\nconst processFiles = currify(_processFiles);\n\nconst noFilesCheck = () => {\n    const {length} = DOM.getActiveFiles();\n    const is = Boolean(!length);\n    \n    if (is)\n        return Dialog.alert.noFiles(TITLE);\n    \n    return is;\n};\n\nmodule.exports.init = promisify((callback) => {\n    showLoad();\n    \n    exec.series([\n        DOM.loadSocket,\n        (callback) => {\n            if (!config('progress') || config('dropbox'))\n                return callback();\n            \n            const {\n                prefix,\n                prefixSocket,\n            } = CloudCmd;\n            load(initOperations(prefix, prefixSocket, callback));\n        },\n        (callback) => {\n            Loaded = true;\n            Images.hide();\n            callback();\n        },\n    ], callback);\n});\n\nfunction _authCheck(spawn, ok) {\n    const accept = wraptile(ok);\n    const alertDialog = wraptile(Dialog.alert);\n    \n    spawn.on('accept', accept(spawn));\n    spawn.on('reject', alertDialog (TITLE, 'Wrong credentials!'));\n    spawn.emit('auth', config('username'), config('password'));\n}\n\nfunction _initOperations(prefix, socketPrefix, fn) {\n    socketPrefix = `${socketPrefix}/fileop`;\n    fileop({prefix, socketPrefix}, (e, operator) => {\n        fn();\n        \n        operator.on('connect', authCheck(operator, onConnect));\n        operator.on('disconnect', onDisconnect);\n    });\n}\n\nfunction onConnect(operator) {\n    packTarFn = ({from, to, names}, callback) => {\n        const operation = 'Tar';\n        const listen = setListeners({\n            operation,\n            callback,\n            noContinue: true,\n            from,\n            to,\n        });\n        \n        operator.tar(from, to, names)\n            .then(listen);\n    };\n    \n    packZipFn = ({from, to, names}, callback) => {\n        const operation = 'Zip';\n        const listen = setListeners({\n            operation,\n            callback,\n            noContinue: true,\n            from,\n            to,\n        });\n        \n        operator.zip(from, to, names)\n            .then(listen);\n    };\n    \n    deleteFn = (from, files, callback) => {\n        from = removeQuery(from);\n        \n        const operation = 'Delete';\n        const listen = setListeners({\n            operation,\n            callback,\n            from,\n        });\n        \n        operator.remove(from, files)\n            .then(listen);\n    };\n    \n    copyFn = ({from, to, names}, callback) => {\n        const operation = 'Copy';\n        const listen = setListeners({\n            operation,\n            callback,\n            from,\n            to,\n            names,\n        });\n        \n        operator.copy(from, to, names)\n            .then(listen);\n    };\n    \n    moveFn = ({from, to, names}, callback) => {\n        const operation = 'Move';\n        const listen = setListeners({\n            operation,\n            callback,\n            from,\n            to,\n        });\n        \n        operator.move(from, to, names)\n            .then(listen);\n    };\n    \n    extractFn = ({from, to}, callback) => {\n        const operation = 'Extract';\n        const listen = setListeners({\n            operation,\n            callback,\n            noContinue: true,\n            from,\n            to,\n        });\n        \n        operator.extract(from, to)\n            .then(listen);\n    };\n}\n\nfunction onDisconnect() {\n    packZipFn = RESTful.pack;\n    packTarFn = RESTful.pack;\n    deleteFn = RESTful.delete;\n    copyFn = RESTful.cp;\n    moveFn = RESTful.mv;\n    extractFn = RESTful.extract;\n}\n\nfunction getPacker(type) {\n    if (type === 'zip')\n        return packZipFn;\n    \n    return packTarFn;\n}\n\nmodule.exports.hide = () => {\n    CloudCmd.View.hide();\n};\n\nmodule.exports.show = (operation, data) => {\n    if (!Loaded)\n        return;\n    \n    if (operation === 'copy')\n        return Operation.copy(data);\n    \n    if (operation === 'move')\n        return Operation.move(data);\n    \n    if (operation === 'delete')\n        return Operation.delete();\n    \n    if (operation === 'delete:silent')\n        return Operation.deleteSilent();\n    \n    if (operation === 'pack')\n        return Operation.pack();\n    \n    if (operation === 'extract')\n        return Operation.extract();\n};\n\nOperation.copy = processFiles({\n    type: 'copy',\n});\n\nOperation.move = processFiles({\n    type: 'move',\n});\n\nOperation.delete = () => {\n    promptDelete();\n};\n\nOperation.deleteSilent = () => {\n    deleteSilent();\n};\n\nOperation.pack = () => {\n    const isZip = config('packer') === 'zip';\n    twopack('pack', isZip ? 'zip' : 'tar');\n};\n\nOperation.extract = () => {\n    twopack('extract');\n};\n\n/**\n * prompt and delete current file or selected files\n *\n * @currentFile\n */\nfunction promptDelete() {\n    if (noFilesCheck())\n        return;\n    \n    const msgAsk = 'Do you really want to delete the ';\n    const msgSel = 'selected ';\n    \n    const files = DOM.getActiveFiles();\n    const names = DOM.getFilenames(files);\n    const n = names.length;\n    \n    let msg;\n    \n    if (n) {\n        let name = '';\n        \n        for (let i = 0; i < 5 && i < n; i++)\n            name += '\\n' + names[i];\n        \n        if (n >= 5)\n            name += '\\n...';\n        \n        msg = msgAsk + msgSel + n + ' files/directories?\\n' + encode(name);\n    } else {\n        const current = DOM.getCurrentFile();\n        const isDir = DOM.isCurrentIsDir(current);\n        const getType = (isDir) => {\n            return isDir ? 'directory' : 'file';\n        };\n        \n        const type = getType(isDir) + ' ';\n        \n        const name = DOM.getCurrentName(current);\n        msg = msgAsk + msgSel + type + name + '?';\n    }\n    \n    const cancel = false;\n    \n    Dialog.confirm(TITLE, msg, {cancel}).then(() => {\n        deleteSilent(files);\n    });\n}\n\n/**\n * delete current or selected files\n *\n * @files\n */\nfunction deleteSilent(files = DOM.getActiveFiles()) {\n    const query = '?files';\n    const path = Info.dirPath;\n    \n    if (noFilesCheck())\n        return;\n    \n    showLoad();\n    \n    const removedNames = DOM.getFilenames(files);\n    const names = DOM.CurrentInfo.files.map(DOM.getCurrentName);\n    const currentName = DOM.getCurrentName();\n    const nextCurrentName = getNextCurrentName(currentName, names, removedNames);\n    \n    deleteFn(path + query, removedNames, () => {\n        CloudCmd.refresh(() => {\n            const names = Info.files.map(DOM.getCurrentName);\n            const isCurrent = names.includes(currentName);\n            \n            const name = isCurrent ? currentName : nextCurrentName;\n            \n            DOM.setCurrentByName(name);\n        });\n    });\n}\n\n/*\n * process files (copy or move)\n * @param data\n * @param operation\n */\nfunction _processFiles(options, data) {\n    let selFiles;\n    let files;\n    let panel;\n    let shouldAsk;\n    let ok;\n    \n    let from = '';\n    let to = '';\n    \n    let names = [];\n    \n    /* eslint no-multi-spaces: 0 */\n    \n    if (data) {\n        from        = data.from;\n        to          = data.to;\n        names       = data.names;\n        panel       = Info.panel;\n    } else {\n        from        = Info.dirPath;\n        to          = DOM.getNotCurrentDirPath();\n        selFiles    = DOM.getSelectedFiles();\n        names       = DOM.getFilenames(selFiles);\n        data        = {};\n        shouldAsk   = true;\n        panel       = Info.panelPassive;\n    }\n    \n    if (!names.length)\n        names.push(DOM.getCurrentName());\n    \n    const [name] = names;\n    \n    const sameName = DOM.getCurrentByName(name, panel);\n    \n    if (!data && noFilesCheck())\n        return;\n    \n    const {type} = options;\n    \n    const isCopy = type === 'copy';\n    const option = isCopy ? 'confirmCopy' : 'confirmMove';\n    const title = isCopy ? 'Copy' : 'Rename/Move';\n    const operation = isCopy ? copyFn : moveFn;\n    \n    if (shouldAsk && config(option))\n        return message(title, to, names.map(encode))\n            .then(ask);\n    \n    ask(to);\n    \n    function ask(to) {\n        ok = from !== to && to;\n        \n        if (ok && !shouldAsk || !sameName)\n            return go();\n        \n        const str = `\"${ name }\" already exist. Overwrite?`;\n        const cancel = false;\n        \n        Dialog.confirm(TITLE, str, {cancel}).then(go);\n        \n        function go() {\n            showLoad();\n            \n            files = {\n                from,\n                to,\n                names,\n            };\n            \n            operation(files, () => {\n                DOM.Storage.remove(from, () => {\n                    const {\n                        panel,\n                        panelPassive,\n                    } = Info;\n                    \n                    const setCurrent = () => {\n                        const currentName = name || data.names[0];\n                        DOM.setCurrentByName(currentName);\n                    };\n                    \n                    if (!Info.isOnePanel)\n                        CloudCmd.refresh({\n                            panel: panelPassive,\n                            noCurrent: true,\n                        });\n                    \n                    CloudCmd.refresh({panel}, setCurrent);\n                });\n            });\n        }\n    }\n}\n\nfunction checkEmpty(name, operation) {\n    if (!operation)\n        throw Error(name + ' could not be empty!');\n}\n\nfunction twopack(operation, type) {\n    let op;\n    let fileFrom;\n    let currentName = Info.name;\n    \n    const {\n        path,\n        dirPath,\n    } = Info;\n    \n    const activeFiles = DOM.getActiveFiles();\n    const names = DOM.getFilenames(activeFiles);\n    \n    checkEmpty('operation', operation);\n    \n    if (!names.length)\n        return Dialog.alert.noFiles(TITLE);\n    \n    switch(operation) {\n    case 'extract':\n        op = extractFn;\n        \n        fileFrom   = {\n            from: path,\n            to: dirPath,\n        };\n        \n        currentName = removeExtension(currentName);\n        \n        break;\n    \n    case 'pack':\n        op = getPacker(type);\n        \n        if (names.length > 1)\n            currentName  = Info.dir;\n        \n        currentName += DOM.getPackerExt(type);\n        \n        fileFrom = {\n            from: dirPath,\n            to: dirPath + currentName,\n            names,\n        };\n        break;\n    }\n    \n    showLoad();\n    \n    op(fileFrom, (error) => {\n        !error && CloudCmd.refresh({\n            currentName,\n        });\n    });\n}\n\nfunction message(msg, to, names) {\n    const n = names.length;\n    const [name] = names;\n    \n    msg += ' ';\n    \n    if (names.length > 1)\n        msg     += n + ' file(s)';\n    else\n        msg     += '\"' + name + '\"';\n    \n    msg += ' to';\n    \n    const cancel = false;\n    \n    return Dialog.prompt(TITLE, msg, to, {cancel});\n}\n\nfunction load(callback) {\n    const {prefix} = CloudCmd;\n    const file = `${prefix}/fileop/fileop.js`;\n    \n    loadJS(file, (error) => {\n        if (error) {\n            Dialog.alert(TITLE, error.message);\n            return exec(callback);\n        }\n        \n        Loaded = true;\n        Util.timeEnd(Name + ' load');\n        exec(callback);\n    });\n    \n    Util.time(Name + ' load');\n}\n\n","'use strict';\n\nconst {getExt} = require('../../../common/util');\n\nmodule.exports = (name) => {\n    const ext = getExtension(name);\n    \n    return name.replace(ext, '');\n};\n\nfunction getExtension(name) {\n    if (/\\.tar\\.gz$/.test(name))\n        return '.tar.gz';\n    \n    if (/\\.tar\\.bz2$/.test(name))\n        return '.tar.bz2';\n    \n    return getExt(name);\n}\n\n","'use strict';\n\n/* global DOM */\n/* global CloudCmd */\n\nconst smalltalk = require('smalltalk');\n\nconst {\n    Dialog,\n    Images,\n} = DOM;\n\nconst forEachKey = require('for-each-key/legacy');\nconst wraptile = require('wraptile/legacy');\nconst {TITLE} = CloudCmd;\n\nconst format = require('./format');\n\nmodule.exports = (options) => (emitter) => {\n    const {\n        operation,\n        callback,\n        noContinue,\n        from,\n        to,\n    } = options;\n    \n    let done;\n    let lastError;\n    \n    const onAbort = wraptile(({emitter, operation}) => {\n        emitter.abort();\n        \n        const msg = `${operation} aborted`;\n        lastError = true;\n        \n        Dialog.alert(TITLE, msg, {\n            noCancel: true,\n        });\n    });\n    \n    const removeListener = emitter.removeListener.bind(emitter);\n    const on = emitter.on.bind(emitter);\n    \n    const message = format(operation, from, to);\n    \n    const progress = smalltalk.progress(TITLE, message);\n    \n    progress.catch(onAbort({\n        emitter,\n        operation,\n    }));\n    \n    const listeners = {\n        progress: (value) => {\n            done = value === 100;\n            progress.setProgress(value);\n        },\n        \n        end: () => {\n            Images.hide();\n            forEachKey(removeListener, listeners);\n            \n            if (lastError || done)\n                callback();\n        },\n        \n        error: (error) => {\n            lastError = error;\n            \n            if (noContinue) {\n                listeners.end(error);\n                Dialog.alert(TITLE, error);\n                return;\n            }\n            \n            Dialog.confirm(TITLE, error + '\\n Continue?')\n                .then(() => {\n                    emitter.continue();\n                }, () => {\n                    emitter.abort();\n                });\n        },\n    };\n    \n    forEachKey(on, listeners);\n};\n\n","'use strict';\n\nmodule.exports = (operation, from, to) => {\n    if (!to)\n        return `${operation} ${from}`;\n    \n    return `${operation} ${from} -> ${to}`;\n};\n\n","'use strict';\n\nconst currify = require('currify/legacy');\n\nconst not = currify((array, value) => !~array.indexOf(value));\nconst notOneOf = currify((a, b) => a.filter(not(b)));\n\nmodule.exports = (currentName, names, removedNames) => {\n    const i = names.indexOf(currentName);\n    \n    const nextNames = notOneOf(names, removedNames);\n    const {length} = nextNames;\n    \n    if (nextNames[i])\n        return nextNames[i];\n    \n    return nextNames[length - 1];\n};\n\n"],"sourceRoot":""}