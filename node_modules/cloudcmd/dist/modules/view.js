!function(e){function n(n){for(var r,u,f=n[0],c=n[1],a=n[2],s=0,p=[];s<f.length;s++)u=f[s],o[u]&&p.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(l&&l(n);p.length;)p.shift()();return i.push.apply(i,a||[]),t()}function t(){for(var e,n=0;n<i.length;n++){for(var t=i[n],r=!0,f=1;f<t.length;f++){var c=t[f];0!==o[c]&&(r=!1)}r&&(i.splice(n--,1),e=u(u.s=t[0]))}return e}var r={},o={17:0},i=[];function u(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,u),t.l=!0,t.exports}u.m=e,u.c=r,u.d=function(e,n,t){u.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},u.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,n){if(1&n&&(e=u(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(u.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var r in e)u.d(t,r,function(n){return e[n]}.bind(null,r));return t},u.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(n,"a",n),n},u.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},u.p="/dist/";var f=window.webpackJsonp=window.webpackJsonp||[],c=f.push.bind(f);f.push=n,f=f.slice();for(var a=0;a<f.length;a++)n(f[a]);var l=c;i.push([89,0]),t()}({144:function(e,n){},89:function(e,n,t){"use strict";function r(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.forEach(function(n){o(e,n,t[n])})}return e}function o(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n,t,r,o,i,u){try{var f=e[i](u),c=f.value}catch(e){return void t(e)}f.done?n(c):Promise.resolve(c).then(r,o)}function u(e){return function(){var n=this,t=arguments;return new Promise(function(r,o){var u=e.apply(n,t);function f(e){i(u,r,o,f,c,"next",e)}function c(e){i(u,r,o,f,c,"throw",e)}f(void 0)})}}t(144);var f=t(8),c=t(11),a=t(0),l=t(1),s=t(6).promisify,p=t(90),d=t(2),v=t(9).time,y=t(5).FS,h=t(14),m=t(15),b=t(4),g=t(3),w=t(17).encode,O=l(function(e,n){return n.test(e)}),x=l(function(e,n,t,r){return e(r,n,t)})(m.add),C=function(e){return RegExp("\\.".concat(e,"$"),"i")},S=s(b.css);e.exports.show=function(e,n){var t=CloudCmd.prefixURL+y;if(j)return;n&&!1===n.bindKeys||m.addKey($);if((M=d("div",{className:"view",notAppend:!0})).tabIndex=0,e)return M.append(e),void p.open(M,function(e,n){var t=r({},e);return n?(Object.keys(n).forEach(function(e){var r=!!t[e],o=n[e];if(f.function(o)&&r){var i=t[e];t[e]=function(){a.series([i,o])}}else t[e]=n[e]}),t):t}(F,n));g.show.load();var o=t+D.path;switch(function(e){if(T(e))return"image";if(function(e){return z(e)||function(e){return/\.(mp4|avi)$/i.test(e)}(e)}(e))return"media"}(o)){default:return void D.getData(function(e,n){if(e)return g.hide();var t=document.createTextNode(n),o=r({},F);CloudCmd.config("showFileName")&&(o.title=D.name),M.append(t),p.open(M,o)});case"image":return function(e){var n=D.files.map(DOM.getCurrentPath).filter(T),t=n.map(function(n){return{href:e+n,title:w(_(n))}}),o=n.indexOf(D.path),i=r({},F,{index:o,autoSize:!0,arrows:!0,keys:!0,helpers:{title:{}}});p.open(t,i)}(t);case"media":return function(e){n=e,t=function(e){var n=r({},F,{autoSize:!0,afterShow:function(){e.querySelector("audio, video").focus()}});p.open(e,n)},function(e,n){if("string"!=typeof e)throw Error("src should be a string!");if("function"!=typeof n)throw Error("callback should be a function")}(n,t),h.get("view/media-tmpl",function(e,r){var o=D.name;if(e)return alert(e);k||(k=r);var i=z(o),u=i?"audio":"video",f=c(k,{src:n,type:u,name:o}),a=d("div",{innerHTML:f});t(a)});var n,t}(o)}},e.exports.hide=K;var j=!1,P="View";CloudCmd[P]=e.exports;var M,k,D=DOM.CurrentInfo,E=CloudCmd.Key,_=function(e){return e.split("/").pop()},F={beforeShow:function(e){g.hide(),E.unsetBind(),a(e)},beforeClose:function(e){m.rmKey($),E.setBind(),a(e)},afterShow:function(e){M.focus(),a(e)},onOverlayClick:N,afterClose:a,autoSize:!1,helpers:{title:{}}};function K(){p.close()}function T(e){return["jp(e|g|eg)","gif","png","bmp","webp","svg","ico"].map(C).some(O(e))}function z(e){return/\.(mp3|ogg|m4a)$/i.test(e)}function B(){return(B=u(function*(){var e=CloudCmd.prefix;v(P+" load"),j=!0,yield S("".concat(e,"/dist/view.css")),j=!1})).apply(this,arguments)}function N(e){!function(e){var n=DOM.getCurrentByPosition(e);if(!n)return;var t=D.files,r=D.filesPassive,o=~t.indexOf(n),i=~r.indexOf(n);if(!o&&!i)return;if(DOM.isCurrentFile(n))return;DOM.setCurrentFile(n)}({x:e.clientX,y:e.clientY})}function $(e){e.keyCode===E.ESC&&K()}e.exports.init=u(function*(){yield function(){return B.apply(this,arguments)}();["click","contextmenu"].forEach(x(void 0,N))})}});
//# sourceMappingURL=view.js.map